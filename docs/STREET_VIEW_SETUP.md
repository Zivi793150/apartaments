# Настройка 360° панорамы окружения (Google Street View)

## Быстрый старт

### Вариант 1: Использование Google Street View API (Рекомендуется)

1. **Получите API ключ Google Maps:**
   - Перейдите на [Google Cloud Console](https://console.cloud.google.com/)
   - Создайте проект или выберите существующий
   - Включите "Street View Static API"
   - Создайте API ключ в разделе "Credentials"

2. **Добавьте ключ в переменные окружения:**
   
   Создайте файл `.env.local`:
   ```env
   NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=ваш_ключ_здесь
   NEXT_PUBLIC_BUILDING_LAT=36.7731
   NEXT_PUBLIC_BUILDING_LNG=-4.0396
   ```
   
   Где:
   - `NEXT_PUBLIC_GOOGLE_MAPS_API_KEY` - ваш API ключ Google Maps
   - `NEXT_PUBLIC_BUILDING_LAT` - широта вашего здания
   - `NEXT_PUBLIC_BUILDING_LNG` - долгота вашего здания

3. **Получите точные координаты здания:**
   
   Используйте [Google Maps](https://www.google.com/maps) для поиска адреса:
   - Найдите ваше здание на карте
   - Кликните правой кнопкой на здание
   - Выберите координаты и скопируйте их
   - Вставьте в `.env.local`

   Или используйте Geocoding API:
   ```bash
   curl "https://maps.googleapis.com/maps/api/geocode/json?address=C.+Cam.+de+Velez,+15,+Альгарробо&key=YOUR_API_KEY"
   ```

4. **Готово!** Панорама загрузится автоматически.

### Вариант 2: Использование готовой 360° панорамы

Если у вас уже есть 360° фотография:

1. **Поместите панораму в `public/panoramas/`:**
   ```
   public/
     panoramas/
       street-view-360.jpg
   ```

2. **Формат панорамы:**
   - Рекомендуемое разрешение: 2048x1024 или выше
   - Формат: JPG или PNG
   - Тип: Equirectangular (360° панорама)

3. **Где взять 360° панорамы:**
   - Сделать самостоятельно (камера 360° или телефон)
   - [Poly Haven](https://polyhaven.com/hdris) - бесплатные HDR панорамы
   - [Sketchfab](https://sketchfab.com/) - 3D модели и панорамы
   - Google Street View (через API)

### Вариант 3: Создание панорамы из Google Street View вручную

Если нужно получить панораму из Google Street View без API:

1. **Откройте Google Maps:**
   - Найдите ваше здание
   - Переключитесь в режим Street View (желтый человечек)

2. **Сделайте скриншоты:**
   - Поворачивайте камеру и делайте скриншоты в разных направлениях
   - Используйте инструменты для склейки панорамы (например, PTGui, Hugin)

3. **Или используйте инструменты:**
   - [Street View Download 360](https://www.360cities.net/) - скачивание панорам
   - [Panorama Stitcher](https://www.ptgui.com/) - склейка панорам

## Настройка направления панорамы

В `EstateBrowser3D.tsx` можно настроить направление панорамы:

```tsx
const panoramaUrl = getGoogleStreetViewUrl(
  buildingCoords.lat,
  buildingCoords.lng,
  apiKey,
  "2048x1024",
  120, // FOV (90-120)
  0,   // heading: 0=север, 90=восток, 180=юг, 270=запад
  0    // pitch: -90 до 90 (угол наклона)
);
```

## Оптимизация производительности

- **Разрешение:** Используйте 2048x1024 для баланса качества и производительности
- **Кэширование:** Панорамы кэшируются браузером автоматически
- **Lazy Loading:** Панорама загружается только при включении Street View

## Лимиты Google Street View API

- **Бесплатный тариф:** 28,000 запросов/месяц
- **Разрешение:** До 640x640 для бесплатного тарифа, до 2048x2048 для платного
- **FOV:** До 120 градусов

## Решение проблем

### Панорама не загружается

1. Проверьте API ключ в `.env.local`
2. Убедитесь, что "Street View Static API" включен
3. Проверьте координаты здания
4. Убедитесь, что для этого места есть Street View

### Панорама не в том направлении

Измените параметр `heading` в `getGoogleStreetViewUrl()`:
- 0 = север
- 90 = восток  
- 180 = юг
- 270 = запад

### Низкое качество панорамы

1. Увеличьте разрешение в параметре `size` (например, "4096x2048")
2. Используйте платный тариф Google Maps API для более высокого разрешения

