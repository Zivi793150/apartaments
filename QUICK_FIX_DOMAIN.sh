#!/bin/bash

# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–æ–º–µ–Ω–∞

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –ø–æ—Ä—Ç—É 3000
echo "1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ localhost:3000"
if curl -s http://localhost:3000 | grep -q "AUREO\|apart-site"; then
    echo "‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000"
else
    echo "‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000"
    echo "   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: pm2 restart apart-site"
fi
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PM2
echo "2. –°—Ç–∞—Ç—É—Å PM2:"
pm2 status
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
echo "3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 3000:"
netstat -tulpn | grep 3000 || echo "   –ü–æ—Ä—Ç 3000 –Ω–µ –∑–∞–Ω—è—Ç"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx
echo "4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx –¥–ª—è –¥–æ–º–µ–Ω–∞:"
sudo grep -r "site.endless-summer.ru" /etc/nginx/ 2>/dev/null | head -5 || echo "   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ /etc/nginx/"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl
echo "5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–º–µ–Ω–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω):"
curl -I https://site.endless-summer.ru 2>/dev/null | head -5 || echo "   –î–æ–º–µ–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
echo ""

echo "üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:"
echo "   1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Nginx Proxy Manager Forward Port = 3000"
echo "   2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ: pm2 status"
echo "   3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: pm2 logs apart-site"

